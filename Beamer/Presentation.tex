\documentclass[20pt,mathserif]{beamer}

%Standarteinstellungen
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}

%Mathepackages
\usepackage{amsmath,amssymb,amsfonts,amsthm,mathtools}

%Tabellen tools
\usepackage{tabularx}
\usepackage{graphicx}

%Zeichnungen
\usepackage{tikz}
\usetikzlibrary{patterns,snakes}

%Anderthalbfacher Zeilenabstand
\usepackage{setspace}

%Farbe Section/Frametitles
\setbeamercolor{title}{fg=blue}
\setbeamercolor{frametitle}{fg=blue}

%Bulletpoints statt Bullettriangles
\setbeamertemplate{itemize item}[circle]

%Bulletpoints Farbe
\setbeamercolor{itemize item}{fg=blue} 

%Seitennummerierung
\setbeamertemplate{footline}[frame number] 

%Vordefinierte Umgebungen
\newtheorem{defi}{Definition}[subsection]
\newtheorem{satz}{Satz}[subsection]
\newtheorem{koro}{Korollar}[subsection]
\newtheorem{prop}{Proposition}[subsection] 

%Vordefinierte Befehle
\newcommand{\E}{\mathrm{E}}
\newcommand{\Var}{\mathrm{Var}}

%Erstllt Section Ãœberschrift als Einzelnen Frame
\AtBeginSection[]{
	\begin{frame}
	\vfill
	\centering
	\begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
		\usebeamerfont{title}\insertsectionhead\par%
	\end{beamercolorbox}
	\vfill
\end{frame}
}

%Titelblatt
\title[Cross Validation]{ Linear Model selection by Cross-Validation}
%\subtitle{Researchmodule Econometrics}
\author{ Vivien Fritzsche, Jan Scherer, \\ Christoph Zilligen}
\date{\today}

\begin{document}
\beamertemplatenavigationsymbolsempty
\begin{frame}
\titlepage
\thispagestyle{empty}
\end{frame}

\begin{frame}
\frametitle{Real Data Problem}
\begin{itemize}
	\item hier Scatterplot
\end{itemize}
\end{frame}

\thispagestyle{empty}
\section{General Framework}

\begin{frame}
\frametitle{Linear Setting}
\[
	y_i=x_i^\prime\beta+\varepsilon_i
\]
$x_i$ deterministic\\\vspace*{5pt}
$\E[\varepsilon_i]=0$\\\vspace*{5pt}
$\Var(\varepsilon_i)=\sigma^2<\infty$ $\forall i$
\end{frame}

\begin{frame}
\frametitle{Notation}
\begin{itemize}
	\item $\hat{y}=X\hat{\beta}=X(X^\prime X)^{-1} X^\prime y$
	\item $\alpha \subset \{1,\ldots,n\}$
	\item $d_\alpha=|\alpha|$
	\item $ASPE_\alpha = n^{-1} ||y-\hat{y}_\alpha||\equiv\Gamma_\alpha$
	\item 
	%X_\alpha is a d_\alpha vector containing the components of X,that are indexed by the integers in \alpha
\end{itemize}
\end{frame}


\begin{frame}
\frametitle{Methods for Model Selection}

\begin{align*}
&\Gamma=n^{-1}||y-\hat{y}||^2
\\\\
&AIC = 2k - 2\ln(\hat{L})\hspace{30cm}
\\\\
&BIC = \ln(n)k - 2\ln(\hat{L})
\end{align*}
\end{frame}

\begin{frame}
\frametitle{Cross Validation}
\vspace*{1.5cm}
\begin{overprint}
	\only<+>{
	\begin{tikzpicture}
		\node at (0,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (2,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (4,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (6,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (8,0)[draw,inner sep=0.8em,fill = red,label= below:{\tiny validation}]{} ;
		\node at (10,0)[draw,inner sep=0.8em,fill =red,label= below:{\tiny validation}]{} ;
	\end{tikzpicture}
	\vspace*{70cm}
	}
	\only<+>{
		\begin{tikzpicture}
		\node at (0,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (2,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (4,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (6,0)[draw,inner sep=0.8em,fill = red, label= below:{\tiny validation}]{} ;
		\node at (8,0)[draw,inner sep=0.8em, fill =gray]{} ;
		\node at (10,0)[draw,inner sep=0.8em,fill =red,label= below:{\tiny validation}]{} ;
		\end{tikzpicture}
		\vspace*{70cm}
	}
	\only<+>{
		\begin{tikzpicture}
		\node at (0,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (2,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (4,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (6,0)[draw,inner sep=0.8em,fill = red, label= below:{\tiny validation}]{} ;
		\node at (8,0)[draw,inner sep=0.8em,fill =red,label= below:{\tiny validation}]{} ;
		\node at (10,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\end{tikzpicture}
		\vspace*{70cm}
	}
	\only<+>{
		\begin{tikzpicture}
		\node at (0,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (2,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (4,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (6,0)[draw,inner sep=0.8em,fill = red, label= below:{\tiny validation}]{} ;
		\node at (8,0)[draw,inner sep=0.8em,fill =red,label= below:{\tiny validation}]{} ;
		\node at (10,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\end{tikzpicture}
		\begin{align*}
		&CV={\color{white} |P|^{-1}\sum_{s \in P}}\underbrace{n^{-1}_\nu||y_s-\hat{y}_{\alpha,s^c} ||^2}_{\hat{\Gamma}_{\alpha,s}} &\hspace{15cm}&
		\end{align*}
		\vspace{20cm}
	}
	\only<+>{
		\begin{tikzpicture}
		\node at (0,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (2,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (4,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (6,0)[draw,inner sep=0.8em,fill = red, label= below:{\tiny validation}]{} ;
		\node at (8,0)[draw,inner sep=0.8em,fill =red,label= below:{\tiny validation}]{} ;
		\node at (10,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\end{tikzpicture}
		\begin{align*}
		&CV={\color{red} |P|^{-1}\sum_{s \in P}}\underbrace{n^{-1}_\nu||y_s-\hat{y}_{\alpha,s^c} ||^2}_{\hat{\Gamma}_{\alpha,s}} &\hspace{15cm}&
		\end{align*}
		\vspace{20cm}
	}
	\only<+>{
		\begin{tikzpicture}
		\node at (0,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (2,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (4,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (6,0)[draw,inner sep=0.8em,fill = red, label= below:{\tiny validation}]{} ;
		\node at (8,0)[draw,inner sep=0.8em,fill =red,label= below:{\tiny validation}]{} ;
		\node at (10,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\end{tikzpicture}
		\begin{align*}
		&CV=\color{red}\underbrace{{\color{red} |P|^{-1}\sum_{s \in P}}{\color{black}\underbrace{n^{-1}_\nu||y_s-\hat{y}_{\alpha,s^c} ||^2}_{\hat{\Gamma}_{\alpha,s}}} }_{\hat{\Gamma}_\alpha}&\hspace{15cm}&
		\end{align*}
		\vspace{20cm}
	}
		\only<+>{
		\begin{tikzpicture}
		\node at (0,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (2,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (4,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\node at (6,0)[draw,inner sep=0.8em,fill = red, label= below:{\tiny validation}]{} ;
		\node at (8,0)[draw,inner sep=0.8em,fill =red,label= below:{\tiny validation}]{} ;
		\node at (10,0)[draw,inner sep=0.8em, fill = gray]{} ;
		\end{tikzpicture}
		\begin{align*}
		&CV=|P|^{-1}\sum_{s\in P}n_\nu^{-1}||y_s-\hat{y}_{\alpha,s^c}||^2&\hspace{15cm}&
		\end{align*}
		\vspace{20cm}
	}
\end{overprint}
\end{frame}

\begin{frame}
\frametitle{CV Variants}
\setlength{\tabcolsep}{1pt}
\begin{tabular}{ll}
	CV:& $P=\{s\subset\{1,\ldots,n\}|\#s\equiv n_\nu\}$\\\\
	BICV:& $\mathcal{B}\subset P $ s.t $\# \mathcal{B}=b$\\\\
	MCCV:& $\mathcal{B}\subset P$ s.t $\# \mathcal{B}=b$
\end{tabular}
\end{frame}

\thispagestyle{empty}
\section{Asymptotic Properties}

\begin{frame}
\frametitle{Categories of Models}
\setlength{\tabcolsep}{1pt}
\begin{tabular}{ll}
	{\bfseries Category I}:& At least one $\beta_i\neq0$ is \\&not in $\beta_\alpha$.\\\\
	{\bfseries Category II}:& $\beta_\alpha$ contains all $\beta_i\neq0$.\\\\
\end{tabular}
\end{frame}

\begin{frame}
\frametitle{Theorie CV}
\begin{align*}
&\Gamma_{\alpha,n}=\sigma^2+\Delta_{\alpha,n}+n^{-1}d_\alpha\sigma^2\\\\
&\Delta_{\alpha,n}> 0 \hspace{1.5cm},\text{for }\alpha\in\text{Cat I}\\\\
&\Delta_{\alpha,n}= 0\hspace{1.5 cm},\text{for }\alpha\in\text{Cat II}\hspace{30cm}
\end{align*}
\end{frame}

\begin{frame}
\frametitle{Leave-one-out CV}
\begin{align*}
	&\hspace{0.3cm}\hat{\Gamma}^{CV(1)} _{\alpha,n}=\Gamma_{\alpha,n}+o_p(1)&\hspace{5cm}&\\\\
	&\lim_{n\rightarrow\infty}\mathrm{P}(\mathcal{M}_{CV} \text{ is in Cat I})=0&&\\\\
	&\lim_{n\rightarrow\infty}\mathrm{P}(\mathcal{M}_{CV}=\mathcal{M}^\ast )\neq1&&
\end{align*}
\end{frame}

\begin{frame}
\frametitle{Leave-$n_\nu$-out CV}
\begin{align*}
&\hspace{0.3cm}\hat{\Gamma}^{CV(n_\nu)}_{\alpha,n}=\Gamma_{\alpha,n}+o_p(1)&\hspace{5cm}&\\\\
&\lim_{n\rightarrow\infty}\mathrm{P}(\mathcal{M}_{CV} \text{ is in Cat I})=0&&\\\\
&{\color{red}\lim_{n\rightarrow\infty}\mathrm{P}(\mathcal{M}_{CV}=\mathcal{M}^\ast )=1}&&
\end{align*}
\end{frame}

\begin{frame}
\frametitle{Proof Sketch}
\setlength{\tabcolsep}{1pt}
\begin{tabular}{l}
$\hat{\Gamma}^{CV(1)}_{\alpha,n}=\frac{\varepsilon^\prime\varepsilon}{n}+\frac{2}{n}d_\alpha\sigma^2-\frac{\varepsilon^\prime P_\alpha\varepsilon}{n}+o_p(n^{-1})$\\\\
$\hat{\Gamma}^{CV(n_\nu)}_{\alpha,n}=\frac{\varepsilon^\prime\varepsilon}{n}+\frac{d_\alpha\sigma^2}{n_c}+o_p(n_c^{-1})$
\end{tabular}
\end{frame}

\begin{frame}
\frametitle{Simulation Studies}
\begin{equation*}
y =\begin{pmatrix}
1 & x_{1,2} & \ldots & x_{1,5}\\
\vdots & \vdots& & \vdots\\
1& x_{n,2} &\ldots & x_{n,5}
\end{pmatrix}
\begin{pmatrix}
\beta_1\\
\vdots\\
\beta_5
\end{pmatrix}
+\mathbf{\pmb{\varepsilon}}
\end{equation*}
\begin{itemize}
	\item $x_{j} \sim N(\mathbf{\pmb{\mu}}_j,\mathbf{I}_n\sigma^2_j)$ ~  $ j=2,\ldots5$
	\item $\varepsilon \sim N(0,\mathbf{I}_n)$
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Thanks for your attention }
J. Scherer: s3jasche$@$uni-bonn.de\\
V. Fritzsche: s6vifrit$@$uni-bonn.de\\
C. Zilligen: s3chzill$@$uni-bonn.de

\end{frame}


\end{document}